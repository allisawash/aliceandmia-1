{% macro embed(slug, data='audio', caption='caller()') %}
  {% set caption = caller() if (caption == 'caller()') else caption %}
  {% set page = all_pages_posts|filter_pages('slug', 'eq', slug)|get_page %}
  {% set code = page.config[data] %}

  <figure class="embed full">
    {{ code|safe }}

    {% if caption %}
      <figcaption>
        {{ caption|rst }}
      </figcaption>
    {% endif %}
  </figure>
{% endmacro %}
